<html xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>OneBodyOrbits</title>
      <meta name="generator" content="MATLAB 7.1">
      <meta name="date" content="2010-05-03">
      <meta name="m-file" content="OneBodyOrbits"><style>

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows.  On Gecko-based browsers, the shrink-to-fit doesn't work. */ 
p,h1,h2,div.content div {
  /* for MATLAB's browser */
  width: 600px;
  /* for Mozilla, but the "width" tag overrides it anyway */
  max-width: 600px;
  /* for IE */
  width:expression(document.body.clientWidth > 620 ? "600px": "auto" );
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">One Body Orbits</a></li>
               <li><a href="#2">Boundary Conditions</a></li>
               <li><a href="#3">Integration</a></li>
               <li><a href="#4">Plotting the Results of the Integration</a></li>
               <li><a href="#5">Plotting the Actual Orbit</a></li>
            </ul>
         </div>
         <h2>One Body Orbits<a name="1"></a></h2><pre class="codeinput"><span class="comment">%BY: JAMES T. KEANE, 4/10/2010, UMD</span>
</pre><h2>Boundary Conditions<a name="2"></a></h2><pre>The options here help set up the conditions for the integration.
Without proper parameters, the integration won't go smoothly...</pre><pre class="codeinput">options = odeset(<span class="string">'reltol'</span>, 1e-6, <span class="string">'abstol'</span>, 1e-8);

<span class="comment">%  Initial conditions for 1/radius (0.5) and 1/dR/dp (0), respectively.</span>
<span class="comment">%  Currently, these constants are fairly arbitrary (although as you might</span>
<span class="comment">%  guess, not all initial conditions will actually result in a nice orbit!)</span>
Z0 = [0.5;0];

<span class="comment">%  The starting range of phase is set from 0 to 25*2pi.  Recall that in</span>
<span class="comment">%  spherical coordinates, one revolution is equivelant to 2 pi.  So 25*2pi</span>
<span class="comment">%  is equivelant to about 25 orbits.</span>
PHASE = [0, 25*2*pi];
</pre><h2>Integration<a name="3"></a></h2><pre>Here we're using one particular ordinary differnetial equations solver:
"ode45".  It's taking a function generated by some outside .m file and
integrating it with the boundary conditions (PHASE, Z0) under the ODE
options (options) we set earlier.</pre><pre class="codeinput">[P, Z] = ode45(<span class="string">'OneBodyOrbitsFN'</span>, PHASE, Z0, options);
<span class="comment">%  MATLAB is particular and requires that all functions to be integrated be</span>
<span class="comment">%  specified in their own 'function' m files.  You CANNOT just put the</span>
<span class="comment">%  equation in here!</span>
</pre><h2>Plotting the Results of the Integration<a name="4"></a></h2><pre>First, let's plot the results of the integration (1/r and 1/dr/dp)</pre><pre class="codeinput">figure(1)               <span class="comment">% We're opening a new window to plot in.</span>
hold <span class="string">on</span>
plot(P,Z(:,1),<span class="string">'RED'</span>)    <span class="comment">% Plotting 1/R as a function of phase - in red</span>
plot(P,Z(:,2),<span class="string">'BLUE'</span>)   <span class="comment">% Plotting 1/dR/dp as a function of phase - in blue</span>
xlabel(<span class="string">'Phase angle [rad]'</span>)     <span class="comment">% Generating the x-axis label</span>
ylabel(<span class="string">'1/r, 1/(dr/dphi)'</span>)      <span class="comment">% Generating the y-axis label</span>
title (<span class="string">'Orbital Elements!'</span>)     <span class="comment">% Generating the Title of the plot</span>
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="OneBodyOrbits_01.png"> <h2>Plotting the Actual Orbit<a name="5"></a></h2><pre>Remember, we've been integrating in terms of 1/R --- so we must convert
back to R in order to get an orbital plot like we expect:</pre><pre class="codeinput">ONE=ones(1,size(Z,1));
R=(transpose(ONE))./Z(:,1);

<span class="comment">%  Next, we convert from the p and R we have to x and y coordinates, to</span>
<span class="comment">%  make plotting easier.</span>
X=R.*cos(P);
Y=R.*sin(P);

<span class="comment">%  Finding the maximum extent of R will help us generate nice plots that</span>
<span class="comment">%  fit the orbit's size.</span>
RMAX=max(R)*1.1;

<span class="comment">%  Now to actually plot it up!</span>
figure(2)                   <span class="comment">% Opening a new plotting window.</span>
hold <span class="string">on</span>
axis([-RMAX RMAX -RMAX RMAX]); axis <span class="string">square</span>  <span class="comment">% Making the window the right size, and square in shape.</span>
plot(X,Y)                   <span class="comment">% Plotting the actual orbit.</span>
plot(0,0,<span class="string">'RO'</span>)              <span class="comment">% Putting a little circle at the center - where the Sun is.</span>
xlabel(<span class="string">'x coordinate'</span>)      <span class="comment">% Generating the x-axis label</span>
ylabel(<span class="string">'y coordinate'</span>)      <span class="comment">% Generating the y-axis label</span>
title (<span class="string">'Orbital Plot!'</span>)     <span class="comment">% Generating the Title of the plot</span>
hold <span class="string">off</span>                    <span class="comment">% All done!</span>
</pre><img vspace="5" hspace="5" src="OneBodyOrbits_02.png"> <p class="footer"><br>
            Published with MATLAB&reg; 7.1<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####

%% One Body Orbits
%BY: JAMES T. KEANE, 4/10/2010, UMD

%% Boundary Conditions
%  The options here help set up the conditions for the integration.
%  Without proper parameters, the integration won't go smoothly...
options = odeset('reltol', 1e-6, 'abstol', 1e-8);

%  Initial conditions for 1/radius (0.5) and 1/dR/dp (0), respectively.
%  Currently, these constants are fairly arbitrary (although as you might
%  guess, not all initial conditions will actually result in a nice orbit!)
Z0 = [0.5;0]; 

%  The starting range of phase is set from 0 to 25*2pi.  Recall that in
%  spherical coordinates, one revolution is equivelant to 2 pi.  So 25*2pi
%  is equivelant to about 25 orbits.
PHASE = [0, 25*2*pi];

%% Integration
%  Here we're using one particular ordinary differnetial equations solver:
%  "ode45".  It's taking a function generated by some outside .m file and
%  integrating it with the boundary conditions (PHASE, Z0) under the ODE
%  options (options) we set earlier.
[P, Z] = ode45('OneBodyOrbitsFN', PHASE, Z0, options);
%  MATLAB is particular and requires that all functions to be integrated be
%  specified in their own 'function' m files.  You CANNOT just put the
%  equation in here!

%% Plotting the Results of the Integration
%  First, let's plot the results of the integration (1/r and 1/dr/dp)
figure(1)               % We're opening a new window to plot in.
hold on
plot(P,Z(:,1),'RED')    % Plotting 1/R as a function of phase - in red
plot(P,Z(:,2),'BLUE')   % Plotting 1/dR/dp as a function of phase - in blue
xlabel('Phase angle [rad]')     % Generating the x-axis label    
ylabel('1/r, 1/(dr/dphi)')      % Generating the y-axis label
title ('Orbital Elements!')     % Generating the Title of the plot
hold off

%% Plotting the Actual Orbit
%  Remember, we've been integrating in terms of 1/R REPLACE_WITH_DASH_DASH- so we must convert
%  back to R in order to get an orbital plot like we expect:
ONE=ones(1,size(Z,1));
R=(transpose(ONE))./Z(:,1);

%  Next, we convert from the p and R we have to x and y coordinates, to
%  make plotting easier.
X=R.*cos(P);
Y=R.*sin(P);

%  Finding the maximum extent of R will help us generate nice plots that
%  fit the orbit's size.
RMAX=max(R)*1.1;

%  Now to actually plot it up!
figure(2)                   % Opening a new plotting window.
hold on
axis([-RMAX RMAX -RMAX RMAX]); axis square  % Making the window the right size, and square in shape.
plot(X,Y)                   % Plotting the actual orbit.
plot(0,0,'RO')              % Putting a little circle at the center - where the Sun is.
xlabel('x coordinate')      % Generating the x-axis label
ylabel('y coordinate')      % Generating the y-axis label
title ('Orbital Plot!')     % Generating the Title of the plot
hold off                    % All done!
##### SOURCE END #####
-->
   </body>
</html>